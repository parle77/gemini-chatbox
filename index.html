<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Chatbot</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .debug { background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 5px; }
        input { padding: 10px; width: 300px; }
        button { padding: 10px 20px; margin-left: 10px; }
        .message { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .user { background: #e3f2fd; }
        .bot { background: #f3e5f5; }
    </style>
</head>
<body>
    <h1>Debug Chatbot</h1>
    
    <div class="debug" id="debugOutput">
        <h3>Debug Output:</h3>
        <div id="debugLogs"></div>
    </div>
    
    <div>
        <input type="text" id="chatInput" placeholder="Type a message...">
        <button id="sendBtn">Send</button>
    </div>
    
    <div id="chatMessages"></div>

    <script>
        // Simple debug logger
        function debugLog(message) {
            console.log(message);
            const debugLogs = document.getElementById('debugLogs');
            const logDiv = document.createElement('div');
            logDiv.textContent = new Date().toLocaleTimeString() + ': ' + message;
            debugLogs.appendChild(logDiv);
        }

        // Configuration - TEST WITH PLACEHOLDER VALUES FIRST
        const CONFIG = {
            GEMINI_API_KEY: 'PLACEHOLDER_GEMINI_KEY',
            SUPABASE_URL: 'PLACEHOLDER_SUPABASE_URL',
            SUPABASE_ANON_KEY: 'PLACEHOLDER_SUPABASE_KEY'
        };

        debugLog('Script starting...');
        debugLog('CONFIG loaded: ' + JSON.stringify(CONFIG).substring(0, 100));

        // Test basic functionality
        function addMessage(message, sender) {
            debugLog('Adding message: ' + message + ' from ' + sender);
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message ' + sender;
            messageDiv.textContent = sender.toUpperCase() + ': ' + message;
            chatMessages.appendChild(messageDiv);
        }

        // Simple send function
        function sendMessage() {
            debugLog('sendMessage() called');
            
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            debugLog('Input value: "' + message + '"');
            
            if (!message) {
                debugLog('Empty message, returning');
                return;
            }

            debugLog('Adding user message to UI');
            addMessage(message, 'user');
            input.value = '';

            // Test API key check
            if (!CONFIG.GEMINI_API_KEY || CONFIG.GEMINI_API_KEY === 'PLACEHOLDER_GEMINI_KEY') {
                debugLog('API key is placeholder - adding test response');
                addMessage('API key not configured. This is a test response.', 'bot');
            } else {
                debugLog('API key configured, length: ' + CONFIG.GEMINI_API_KEY.length);
                addMessage('API key is configured. Would call real API here.', 'bot');
            }
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            debugLog('DOM loaded, setting up event listeners');
            
            const input = document.getElementById('chatInput');
            const button = document.getElementById('sendBtn');
            
            if (!input) {
                debugLog('ERROR: Input element not found');
                return;
            }
            
            if (!button) {
                debugLog('ERROR: Button element not found');
                return;
            }
            
            debugLog('Elements found, attaching listeners');
            
            button.addEventListener('click', function() {
                debugLog('Button clicked');
                sendMessage();
            });
            
            input.addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    debugLog('Enter key pressed');
                    sendMessage();
                }
            });
            
            debugLog('Initialization complete');
            input.focus();
        });

        debugLog('Script end reached');
    </script>
</body>
</html>
